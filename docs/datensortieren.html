<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Daten sortieren und filtern mit Excel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/DiCi_Hub_transparent.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./brunchlectures.html" rel="" target="">
 <span class="menu-text">Brunch Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./researchingsuper8.html" rel="" target="">
 <span class="menu-text">Researching Super 8</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.uni-marburg.de/en/fb09/institutes/media-studies/research/research-projects/dici-hub" rel="" target="_blank">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./datensortieren.html">Brunch Lectures</a></li><li class="breadcrumb-item"><a href="./datensortieren.html">Daten sortieren und filtern mit Excel</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Brunch Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datensortieren.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Daten sortieren und filtern mit Excel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datenbereinigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Daten bereinigen und anreichern mit OpenRefine</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datenvisualisieren.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Daten visualisieren mit RAWGraphs</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#was-ist-excel" id="toc-was-ist-excel" class="nav-link active" data-scroll-target="#was-ist-excel">Was ist Excel?</a></li>
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation">Installation</a></li>
  <li><a href="#download-des-beispieldatensatzes" id="toc-download-des-beispieldatensatzes" class="nav-link" data-scroll-target="#download-des-beispieldatensatzes">Download des Beispieldatensatzes</a></li>
  <li><a href="#öffnen-einer-csv-datei-in-excel" id="toc-öffnen-einer-csv-datei-in-excel" class="nav-link" data-scroll-target="#öffnen-einer-csv-datei-in-excel">Öffnen einer csv-Datei in Excel</a>
  <ul class="collapse">
  <li><a href="#möglichkeit-1" id="toc-möglichkeit-1" class="nav-link" data-scroll-target="#möglichkeit-1">Möglichkeit 1</a></li>
  <li><a href="#möglichkeit-2" id="toc-möglichkeit-2" class="nav-link" data-scroll-target="#möglichkeit-2">Möglichkeit 2</a></li>
  <li><a href="#möglichkeit-3" id="toc-möglichkeit-3" class="nav-link" data-scroll-target="#möglichkeit-3">Möglichkeit 3</a></li>
  </ul></li>
  <li><a href="#filtern-der-daten-in-excel" id="toc-filtern-der-daten-in-excel" class="nav-link" data-scroll-target="#filtern-der-daten-in-excel">Filtern der Daten in Excel</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Daten sortieren und filtern mit Excel</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Diese Lecture-Einheit zielt darauf ab, unseren Übungsdatensatz und das csv-Format kennen zu lernen. Hierzu benutzen wir das Tabellenkalkulationsprogramm Excel. Wir schauen uns an, wie eine csv in Excel geöffnet und formatiert werden kann und zeigen grundlegende Excel-Funktion wie das Filtern und Sortieren von Daten.</p>
<section id="was-ist-excel" class="level2">
<h2 class="anchored" data-anchor-id="was-ist-excel">Was ist Excel?</h2>
<p>Excel ist ein kostenpflichtiges Tabellenkalkulationsprogramm von Microsoft. Es dient vor allem der Datenanalyse und -visualisierung und gilt als weltweit verbreitetstes Programm seiner Art.</p>
<p>Excel ist tabellarisch aufgebaut, in</p>
<ul>
<li>durchnummerierte Zeilen:</li>
</ul>
<p><img src="img/00_Excel_Zeile.png" class="img-fluid"></p>
<ul>
<li>und durchalphabetisierte Spalten:</li>
</ul>
<p><img src="img/00_Excel_Spalte.png" class="img-fluid"></p>
<p>Bei einem einzelnen Feld spricht man von einer Zelle.</p>
<p>Zellen können mittels Formeln zueinander in Relation gesetzt werden, zum Beispiel aufsummiert. Eine beliebte Anwendung von Excel ist darum im Rechnungswesen.</p>
<p>Da sich die Höhe und Breite von Zellen automatisch und manuell variieren lassen, gibt es allerdings auch Beispiele für die Zweckentfremdung des Programms zur Herstellung von Pixel Art.</p>
</section>
<section id="installation" class="level2">
<h2 class="anchored" data-anchor-id="installation">Installation</h2>
<p>An den Unis Marburg, Mainz und Frankfurt gibt es jeweils Lizenzverträge, damit die Microsoft Office-Programme (inklusive Excel) von Universitätsangehörigen kostenlos genutzt werden können.</p>
<p>Downloadanleitungen sollten jeweils unter folgenden Links zu finden sein:<br>
Hochschulrechenzentrum der Uni Marburg:<br>
<a href="https://www.uni-marburg.de/de/hrz/dienste/software/microsoft_office">https://www.uni-marburg.de/de/hrz/dienste/software/microsoft_office</a><br>
Zentrum für Datenverarbeitung der Uni Mainz:<br>
<a href="https://www.zdv.uni-mainz.de/jgu-signin-oidc/tag/lizenzen/">https://www.zdv.uni-mainz.de/jgu-signin-oidc/tag/lizenzen/</a><br>
Hochschulrechenzentrum der Uni Frankfurt:<br>
<a href="https://www.rz.uni-frankfurt.de/73202101/Microsoft_Office_f%25C3%25BCr_Studierende">https://www.rz.uni-frankfurt.de/73202101/Microsoft_Office_f%25C3%25BCr_Studierende</a></p>
<p>Ansonsten kann auch eine kostenlose, aber zeitlich begrenzte Testversion verwendet werden: <a href="https://www.microsoft.com/de-de/microsoft-365/try?culture=de-de&amp;country=de">https://www.microsoft.com/de-de/microsoft-365/try?culture=de-de&amp;country=de</a></p>
</section>
<section id="download-des-beispieldatensatzes" class="level2">
<h2 class="anchored" data-anchor-id="download-des-beispieldatensatzes">Download des Beispieldatensatzes</h2>
<p>Der Beispieldatensatz, mit dem wir im Rahmen aller drei Veranstaltungen arbeiten, findet sich unter folgendem <a href="datensaetze/DiCiHubBrunchLectures_Datensatz.csv">Link</a> zum Download.</p>
<p>Bei dem Datensatz handelt es sich um eine csv-Datei. CSV steht dabei für Comma-Separated Values. Dieses Dateiformat hat den Vorteil, dass es sich mit einer Reihe unterschiedlicher Programme öffnen und bearbeiten lässt.</p>
</section>
<section id="öffnen-einer-csv-datei-in-excel" class="level2">
<h2 class="anchored" data-anchor-id="öffnen-einer-csv-datei-in-excel">Öffnen einer csv-Datei in Excel</h2>
<p>Um eine csv-Datei in Excel zu öffnen, kann man auf verschiedene Arten und Weisen vorgehen. Die hier vorgestellte Möglichkeit 1 wird allerdings gegenüber den anderen beiden empfohlen.</p>
<section id="möglichkeit-1" class="level3">
<h3 class="anchored" data-anchor-id="möglichkeit-1">Möglichkeit 1</h3>
<ol type="1">
<li>Zuerst öffnet man Excel.</li>
<li>Dann wählt man oben den Reiter „Daten“ aus und klickt dort auf „Daten abrufen (Power Query)“.</li>
</ol>
<p><img src="img/Moglichkeit1_01_Daten_DatenAbrufen(PowerQuery).png" class="img-fluid"></p>
<ol start="3" type="1">
<li>Daraufhin erscheint eine Übersicht an Optionen, von denen man „Text/CSV“ auswählt und anklickt.</li>
</ol>
<p><img src="img/Moglichkeit1_02_DatenquelleAuswahlen.png" class="img-fluid"></p>
<ol start="4" type="1">
<li>Anschließend durchsucht man seine Dateien nach dem gewünschten Datensatz (in diesem Fall unserem Beispieldatensatz).</li>
</ol>
<p><img src="img/Moglichkeit1_03_Durchsuchen.png" class="img-fluid"></p>
<ol start="5" type="1">
<li>Und klickt auf „Daten importieren“, um diesen in Excel zu öffnen.</li>
</ol>
<p><img src="img/Moglichkeit1_04_DiCiHubDatensatzImportieren.png" class="img-fluid"></p>
<ol start="6" type="1">
<li>Hat man die richtige Datei ausgewählt, klickt man unten auf „Weiter“.</li>
</ol>
<p><img src="img/Moglichkeit1_05_Weiter.png" class="img-fluid"></p>
<ol start="7" type="1">
<li>Excel präsentiert daraufhin eine Voransicht des Datensatzes.</li>
</ol>
<p><img src="img/Moglichkeit1_06_Vorschau_Laden.png" class="img-fluid"></p>
<ol start="8" type="1">
<li><p>Ist man mit den Einstellungen zufrieden, klickt man unten auf „Laden“.</p></li>
<li><p>Excel importiert daraufhin die Daten aus der csv-Datei in Tabellenform, sodass direkt damit gearbeitet werden kann.</p></li>
</ol>
<p><img src="img/Moglichkeit1_DatensatzAlsTabelleFormatiert.png" class="img-fluid"></p>
</section>
<section id="möglichkeit-2" class="level3">
<h3 class="anchored" data-anchor-id="möglichkeit-2">Möglichkeit 2</h3>
<ol type="1">
<li>Man öffnet die CSV-Datei mit Excel im „.xlsx“-Format.</li>
<li>Die Daten sind anschließend in Excel lesbar, allerdings noch nicht verarbeitbar, da sie nicht als Tabelle formatiert sind.</li>
<li>Um die Daten als Tabelle zu formatieren klickt man unter dem Reiter „Start“ auf „Als Tabelle formatieren“.</li>
<li>In dem daraufhin erscheinenden Fenster überprüft man, ob der Datenbereich korrekt ist, und klickt anschließend auf „OK“.</li>
</ol>
</section>
<section id="möglichkeit-3" class="level3">
<h3 class="anchored" data-anchor-id="möglichkeit-3">Möglichkeit 3</h3>
<ol type="1">
<li>Per Rechtsklick auf die CSV-Datei wählt man über die Option „Öffnen mit“ Excel aus.</li>
</ol>
<p><img src="img/Moglichkeit3_01_OffnenMitExcel.png" class="img-fluid"></p>
<ol start="2" type="1">
<li>Die Daten werden hieraufhin in Excel importiert, allerdings werden dabei alle Daten in die erste Spalte gequetscht. Und es erscheint die Hinweisemeldung, dass eventuell nicht alle Daten korrekt importiert wurden.</li>
</ol>
<p><img src="img/Moglichkeit3_02_unformatiert.png" class="img-fluid"></p>
<ol start="3" type="1">
<li>Wer hier noch nicht aufgegeben hat, markiert per Klick auf Spalte A die gesamte Spalte und wählt anschließend unter dem Reiter „Daten“ die Funktion „Text in Spalten“ aus.</li>
</ol>
<p><img src="img/Moglichkeit3_03_Daten_TextInSpalten.png" class="img-fluid"></p>
<ol start="4" type="1">
<li>In dem auftauchenden Fenster wählt man die Option „Mit Trennzeichen versehen“ aus und klickt auf „Weiter“.</li>
</ol>
<p><img src="img/Moglichkeit3_04_MitTrennzeichenVersehen.png" class="img-fluid"></p>
<ol start="5" type="1">
<li>Da es sich um eine CSV-Datei handelt, also um Comma-Separated Values, wählt man als Trennzeichen „Komma“ aus und klickt auf „Weiter“, wenn die Vorschau korrekt aussieht.</li>
</ol>
<p><img src="img/Moglichkeit3_05_TrennzeichenKomma.png" class="img-fluid"></p>
<ol start="6" type="1">
<li>In einem zweiten Optionsfenster hat man anschließend die Möglichkeit einzelne Spalten speziell zu formatieren (zum Beispiel als Datum oder Zahl). Überspringt man diesen Schritt, werden die Daten eventuell fehlerhaft importiert, weil Excel ihnen ein falsches Format zuordnet.</li>
</ol>
<p><img src="img/Moglichkeit3_06_FertigStellen.png" class="img-fluid"></p>
<ol start="7" type="1">
<li>Anschließend klickt man auf „Fertig stellen“ und Excel trennt die Daten aus der ersten Spalte bei jedem Komma in eine neue Spalte ab. Ein mögliches Problem, was dabei auftreten kann, ist dass auch Spalten aufgeteilt werden, die eigentlich zusammen gehören.</li>
</ol>
<p><img src="img/Moglichkeit3_07_DatenInSpalten_Problem.png" class="img-fluid"></p>
<ol start="8" type="1">
<li>Auffällige Fehler sollten an dieser Stelle bereinigt werden (hier zum Beispiel, indem man „i, daniel blake“ wieder in Spalte A zusammenfügt und anschließend alle weiteren Werte aus der Zeile eine Spalte aufrücken lässt).</li>
<li>Wie in Möglichkeit 2 müssen die Werte außerdem unter dem Reiter „Start“ mit der Funktion „Als Tabelle formatieren“ noch in eine Tabelle umgewandelt werden, um weiter mit ihnen arbeiten zu können.</li>
</ol>
<p><img src="img/Moglichkeit3_08_AlsTabelleFormatieren.png" class="img-fluid"></p>
<ol start="10" type="1">
<li>Ist der Datenbereich korrekt, klickt man in dem daraufhin auftauchenden Fenster auf „OK“.</li>
</ol>
<p><img src="img/Moglichkeit3_09_Tabellenbereich.png" class="img-fluid"></p>
<ol start="11" type="1">
<li>Hat man beim Importieren der Daten allerdings nicht alle Spalten korrekt formatiert, lässt sich an diesem Punkt dennoch nicht verlässlich mit der Tabelle arbeiten: Hat Excel manchen Spalten von sich aus ein falsches Format zugeordnet (wie hier in Spalte L: aus dem Rating wird ein Datum), muss unter Umständen der gesamte Prozess wiederholt werden, um am Ende die richtigen Werte zu erhalten (da eine Nachkorrektur der Formatierung der Spalte nicht automatisch zum Ursprungswert führt).</li>
</ol>
<p><img src="img/Moglichkeit3_10_DatenAlsTabelle.png" class="img-fluid"></p>
</section>
</section>
<section id="filtern-der-daten-in-excel" class="level2">
<h2 class="anchored" data-anchor-id="filtern-der-daten-in-excel">Filtern der Daten in Excel</h2>
<p>Wenn man die csv-Datei erfolgreich in Excel geöffnet hat und die Daten in Tabellenform vorliegen, lassen sich diese anschließend einfach durchsuchen, filtern und weiterverarbeiten.</p>
<p>Es kann zum Beispiel hilfreich sein die Filme im Datensatz nach ihrem Erscheinungsjahr zu sortieren.</p>
<ol type="1">
<li>Dazu klickt man auf das kleine Dreieck neben der Spaltenbeschriftung.</li>
</ol>
<p><img src="img/Excel_Filtern_01.png" class="img-fluid"></p>
<ol start="2" type="1">
<li>Daraufhin öffnet sich ein Menüfenster, in dem man zum Beispiel nach einzelnen Jahren Filtern kann, oder sich durch das Klicken auf „Aufsteigend“ alle Titel in der Liste in chronologischer Reihenfolge nach ihrem Erscheinungsjahr anzeigen lassen kann.</li>
</ol>
<p><img src="img/Excel_Filtern_02.png" class="img-fluid"></p>
<p>Entsprechend kann man sich zum Beispiel in der Spalte „Gender“ durch das Menüfenster ausschließlich die Filme männlicher oder weiblicher Regisseure anzeigen lassen:</p>
<p><img src="img/Excel_Filtern_03.png" class="img-fluid"></p>
<p>Oder man ordnet die Filmtitel durch die Auswahl „Aufsteigend“ in alphabetischer Reihenfolge:</p>
<p><img src="img/Excel_Filtern_04.png" class="img-fluid"></p>
<p>Wenn man wieder alle Daten sehen möchte, wählt man die Filter ab. Gefilterte Spalten sind an der Stelle des kleinen Dreiecks markiert und dadurch leicht zu finden.</p>
<p><em>Alle Screenshots wurden von Katharina Kauth erstellt.</em> <em>Zuletzt bearbeitet am 31.10.2023</em></p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">© 2023 <a href="https://www.uni-marburg.de/en/fb09/institutes/media-studies/research/research-projects/dici-hub">Digital Cinema Hub</a>, Marburg - Mainz - Frankfurt. <br> Für die Inhalte externer Seiten übernehmen wir trotz sorgfältiger Überprüfung keine Verantwortung.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>